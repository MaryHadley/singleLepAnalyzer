model = test_model.simple_counting(s = 53.872, n_obs = 536489.0, b = 535570.0, b_uncertainty = 41000.0)
model2 = test_model.simple_counting(s = 75.948, n_obs = 328216.0, b = 346870.0, b_uncertainty = 34000.0)
model3 = test_model.simple_counting(s = 55.39, n_obs = 139693.0, b = 140820.0, b_uncertainty = 17000.0)
model4 = test_model.simple_counting(s = 50.95, n_obs = 68164.0, b = 81987.0, b_uncertainty = 13000.0)
model5 = test_model.simple_counting(s = 93.76, n_obs = 195973.0, b = 197970.0, b_uncertainty = 24000.0)
model6 = test_model.simple_counting(s = 99.279, n_obs = 102094.0, b = 103290.0, b_uncertainty = 15000.0)
model7 = test_model.simple_counting(s = 104.87, n_obs = 58506.0, b = 66387.0, b_uncertainty = 11000.0)
model8 = test_model.simple_counting(s = 65.437, n_obs = 210332.0, b = 216830.0, b_uncertainty = 21000.0)
model9 = test_model.simple_counting(s = 57.769, n_obs = 15753.0, b = 14930.0, b_uncertainty = 2100.0)
model10 = test_model.simple_counting(s = 74.236, n_obs = 13160.0, b = 13546.0, b_uncertainty = 2400.0)
model11 = test_model.simple_counting(s = 39.662, n_obs = 21286.0, b = 22054.0, b_uncertainty = 2500.0)
model12 = test_model.simple_counting(s = 10.737, n_obs = 1077.0, b = 860.0, b_uncertainty = 120.0)
model13 = test_model.simple_counting(s = 26.286, n_obs = 1872.0, b = 1706.0, b_uncertainty = 340.0)

# HTBM180               & 295.29 $\pm$ 21       & 285.7 $\pm$ 21         & 151.07 $\pm$ 17       & 84.639 $\pm$ 13        & 239.5 $\pm$ 16        & 166.46 $\pm$ 14       & 103.37 $\pm$ 15        & 192.57 $\pm$ 15        & 63.173 $\pm$ 7.1      & 65.703 $\pm$ 8.4       & 46.082 $\pm$ 9.9       & 3.8998 $\pm$ 1.3       & 10.799 $\pm$ 3.0       \\                     
# HTBM200               & 219.61 $\pm$ 15       & 215.59 $\pm$ 17        & 147.33 $\pm$ 18       & 62.881 $\pm$ 12        & 185.55 $\pm$ 14       & 156.85 $\pm$ 18       & 97.913 $\pm$ 14        & 143.28 $\pm$ 10.0      & 73.082 $\pm$ 9.2      & 78.802 $\pm$ 9.5       & 62.798 $\pm$ 10        & 12.404 $\pm$ 4.5       & 16.965 $\pm$ 8.8       \\                     
# HTBM250               & 103.46 $\pm$ 8.8      & 110.97 $\pm$ 10        & 74.637 $\pm$ 7.4      & 52.491 $\pm$ 7.5       & 144.54 $\pm$ 10       & 120.35 $\pm$ 9.1      & 112.73 $\pm$ 13        & 100.89 $\pm$ 9.9       & 83.056 $\pm$ 7.7      & 95.377 $\pm$ 10        & 57.507 $\pm$ 6.9       & 15.523 $\pm$ 2.3       & 31.185 $\pm$ 6.0       \\                     
# HTBM300               & 53.872 $\pm$ 5.9      & 75.948 $\pm$ 6.1       & 55.39 $\pm$ 5.7       
# & 50.95 $\pm$ 5.5        & 93.76 $\pm$ 7.3       & 99.279 $\pm$ 6.6      & 104.87 $\pm$ 10        
# & 65.437 $\pm$ 7.1       & 57.769 $\pm$ 5.2      & 74.236 $\pm$ 7.4       & 39.662 $\pm$ 3.1       
# & 10.737 $\pm$ 1.5       & 26.286 $\pm$ 3.9       \\                     
# HTBM350               & 39.97 $\pm$ 3.4       & 50.275 $\pm$ 3.9       & 43.634 $\pm$ 3.8      & 36.524 $\pm$ 4.6       & 72.775 $\pm$ 4.8      & 71.807 $\pm$ 5.3      & 81.267 $\pm$ 7.2       & 41.753 $\pm$ 3.8       & 43.902 $\pm$ 3.2      & 67.299 $\pm$ 6.9       & 31.116 $\pm$ 2.6       & 7.7222 $\pm$ 1.4       & 21.963 $\pm$ 2.6       \\                     
# HTBM400               & 22.985 $\pm$ 2.1      & 35.308 $\pm$ 2.4       & 27.01 $\pm$ 2.6       & 28.184 $\pm$ 2.6       & 43.075 $\pm$ 3.6      & 48.017 $\pm$ 3.7      & 55.368 $\pm$ 4.8       & 27.371 $\pm$ 2.5       & 29.56 $\pm$ 2.3       & 44.867 $\pm$ 4.3       & 21.846 $\pm$ 2.3       & 5.1014 $\pm$ 1.5       & 17.114 $\pm$ 1.9       \\                     
# HTBM450               & 16.24 $\pm$ 1.7       & 24.786 $\pm$ 2.0       & 22.479 $\pm$ 1.7      & 21.714 $\pm$ 2.1       & 29.731 $\pm$ 2.3      & 33.488 $\pm$ 2.2      & 42.877 $\pm$ 3.8       & 16.406 $\pm$ 1.8       & 20.017 $\pm$ 1.5      & 40.161 $\pm$ 3.4       & 12.838 $\pm$ 1.2       & 3.1478 $\pm$ 0.42      & 13.405 $\pm$ 1.4       \\                     
# HTBM500               & 9.6665 $\pm$ 1.1      & 15.271 $\pm$ 1.1       & 14.639 $\pm$ 1.2      & 14.791 $\pm$ 1.6       & 19.3 $\pm$ 1.4        & 20.56 $\pm$ 1.9       & 32.348 $\pm$ 2.7       & 11.153 $\pm$ 1.0       & 12.135 $\pm$ 1.4      & 24.5 $\pm$ 2.1         & 8.7059 $\pm$ 0.71      & 2.5978 $\pm$ 0.37      & 10.156 $\pm$ 1.1       \\                     


model.combine(model2)
model.combine(model3)
model.combine(model4)
model.combine(model5)
model.combine(model6)
model.combine(model7)
model.combine(model8)
model.combine(model9)
model.combine(model10)
model.combine(model11)
model.combine(model12)
model.combine(model13)

model_summary(model)
# result = mle(model, input = 'data', n = 1)
# print "result: ", result
# report.write_html('htmlout')
plot_exp, plot_obs = bayesian_limits(model,'all')#, n_toy = 5000, n_data = 500)
#plot_exp, plot_obs = bayesian_limits(model,'all', n_toy = 100000, n_data = 1000)
#plot_exp, plot_obs = bayesian_limits(model,'expected')
plot_exp.write_txt('expected.txt')
plot_obs.write_txt('observed.txt')

report.write_html('htmlout')